Ejemplo de uso
	1. Install-Package Microsoft.graph (instalar los paquetes necesarios para usar MicrosoftGraph)
	2. Connect-MgGraph -Scopes "User.Read", "Group.ReadWrite.All" (conectarse a MicrosoftGraph)
	3. Remove-MgUserPhoto -UserId "user@domain" (borrar la foto de un usuario en concreto)
	4. Get-MgUserPhoto -UserId ""user@domain" (verificar si el usuario tiene foto en su perfil de O365)
	5. Set-OwaMailboxPolicy -Identity "OwaMailboxPolicy-Default" -SetPhotoEnabled $false (anula la posibilidad de que el usuario pueda poner una foto de perfil en su usuario de O365)
	6. # Conectarse con permisos adecuados
	Connect-MgGraph -Scopes "User.ReadWrite.All"
	# Obtener todos los usuarios habilitados
	$usuarios = Get-MgUser -All -Filter "accountEnabled eq true" (obtener todas las cuentas activas)
	
	foreach ($usuario in $usuarios) {
	    try {
	        Write-Host "Eliminando foto para $($usuario.UserPrincipalName)..."
	        Remove-MgUserPhoto -UserId $usuario.Id -ErrorAction Stop
	        Write-Host "✅ Foto eliminada para $($usuario.UserPrincipalName)"
	    }
	    catch {
	        if ($_.Exception.Message -like "*ImageNotFound*") {
	            Write-Host "ℹ️ No había foto para $($usuario.UserPrincipalName)"
	        } else {
	            Write-Warning "⚠️ Error con $($usuario.UserPrincipalName): $_"
	        }
	    }
	}
	
Gestión de usuarios
# Obtener todos los usuarios
Get-MgUser

# Obtener un usuario específico
Get-MgUser -UserId user@dominio.com

# Crear un nuevo usuario
New-MgUser -DisplayName "Nuevo Usuario" -UserPrincipalName "nuevo@dominio.com" -MailNickname "nuevo" -AccountEnabled $true -PasswordProfile @{ ForceChangePasswordNextSignIn = $true; Password = "Password123!" }

# Actualizar un usuario
Update-MgUser -UserId user@dominio.com -JobTitle "Nuevo Cargo"

# Eliminar un usuario
Remove-MgUser -UserId user@dominio.com


Gestión de Grupos
# Obtener todos los grupos
Get-MgGroup

# Obtener miembros de un grupo
Get-MgGroupMember -GroupId <GroupId>

# Crear un nuevo grupo
New-MgGroup -DisplayName "Equipo de Ventas" -MailEnabled $true -MailNickname "ventas" -SecurityEnabled $false -GroupTypes "Unified"

# Añadir un miembro al grupo
Add-MgGroupMember -GroupId <GroupId> -DirectoryObjectId <UserId>

Correo y Calendario
# Obtener mensajes de un usuario
Get-MgUserMessage -UserId user@dominio.com
# Obtener eventos del calendario de un usuario
Get-MgUserCalendarEvent -UserId user@dominio.com

Aplicaciones
# Obtener todas las aplicaciones registradas
Get-MgApplication

# Obtener detalles de una app
Get-MgApplication -ApplicationId <AppId>

 Desconectar sesión de Graph
Disconnect-MgGraph

Adicionales
Find-MgGraphCommand -Command Get-MgUser

